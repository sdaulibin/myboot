<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~
  ~      Copyright (c) 2018-2025, jic All rights reserved.
  ~
  ~  Redistribution and use in source and binary forms, with or without
  ~  modification, are permitted provided that the following conditions are met:
  ~
  ~ Redistributions of source code must retain the above copyright notice,
  ~  this list of conditions and the following disclaimer.
  ~  Redistributions in binary form must reproduce the above copyright
  ~  notice, this list of conditions and the following disclaimer in the
  ~  documentation and/or other materials provided with the distribution.
  ~  Neither the name of the pig4cloud.com developer nor the names of its
  ~  contributors may be used to endorse or promote products derived from
  ~  this software without specific prior written permission.
  ~  Author: binginx (binginx@gmail.com)
  ~
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="${package}.${moduleName}.mapper.${className}Mapper">

  <resultMap id="${classname}Map" type="${package}.${moduleName}.model.entity.${className}">
    #foreach($column in $columns)
      #if($column.lowerAttrName==$pk.lowerAttrName)
        <id property="${pk.lowerAttrName}" column="${pk.columnName}"/>
      #else
        <result property="${column.lowerAttrName}" column="${column.columnName}"/>
      #end
    #end
  </resultMap>
  <sql id="Base_Column_List">
    #foreach($column in $columns)
        ${column.columnName} #if( $foreach.hasNext ),#end
    #end
  </sql>
  <!-- ${comments}[通用]新增-->
  <insert id="insertSelective" parameterType="${package}.${moduleName}.model.entity.${className}">
    insert into ${tableName}
    <trim prefix="(" suffix=")" suffixOverrides=",">
      #foreach($column in $columns)
      <if test="${column.lowerAttrName} != null ">
        ${column.columnName},
      </if>
      #end
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      #foreach($column in $columns)
      <if test="${column.lowerAttrName} != null ">
          #{${column.lowerAttrName}},
      </if>
      #end
    </trim>
  </insert>
  <!--根据插入所有记录-->
  <insert id="insert" parameterType="${package}.${moduleName}.model.entity.${className}" >
    insert into ${tableName} (
        <include refid="Base_Column_List" />
    ) values (
    #foreach($column in $columns)
      #{${column.lowerAttrName},jdbcType=${column.columnType}} #if( $foreach.hasNext ),#end
    #end
    )
  </insert>
  <!-- 根据表对象数据[通用]修改-->
  <update id="updateByPrimaryKeySelective" parameterType="${package}.${moduleName}.model.entity.${className}">
    update ${tableName}
    <set>
      #foreach($column in $columns)
      <if test="${column.lowerAttrName} != null ">
        ${column.columnName} = #{${column.lowerAttrName}},
      </if>
      #end
    </set>
    where id = #{id}
  </update>
  <!-- 根据主键[通用]修改-->
  <update id="updateByPrimaryKey" parameterType="${package}.${moduleName}.model.entity.${className}">
    update ${tableName}
    <set>
      #foreach($column in $columns)
      <if test="${column.lowerAttrName} != null ">
        ${column.columnName} = #{${column.lowerAttrName}},
      </if>
      #end
    </set>
    where id = #{id}
  </update>
  <!-- 根据表对象数据[通用]删除-->
  <delete id="deleteByPrimaryKey" parameterType="${package}.${moduleName}.model.entity.${className}">
		delete from ${tableName}
		where id = #{id}
	</delete>
  <!-- 根据主键数据[通用]查询-->
  <select id="selectByPrimaryKey" parameterType="${package}.${moduleName}.model.entity.${className}" resultMap="${classname}Map">
    select
    <include refid="Base_Column_List" />
    ,b.coupon as coupon_idVal
    from ${tableName} as a
    left join ${tableName} as b on (a.coupon_id=b.id)
    where id = #{id}
  </select>
  <!-- 根据表对象数据[通用]查询-->
  <select id="selectBySelective" parameterType="${package}.${moduleName}.model.entity.${className}" resultMap="${classname}Map">
    select
    <include refid="Base_Column_List" />
    ,b.coupon as coupon_idVal
    from ${tableName} as a
    left join ${tableName} as b on (a.coupon_id=b.id)
    <where>
      #foreach($column in $columns)
      <if test="${column.lowerAttrName} != null ">
        a.${column.columnName} = #{${column.lowerAttrName}},
      </if>
      #end
    </where>
    ORDER BY id desc
  </select>
  <!-- 根据表对象数据[通用]分页查询-->
  <select id="listPageBySelective" resultMap="${classname}Map">
    select
    <include refid="Base_Column_List" />
    ,b.coupon as coupon_idVal
    from ${tableName} a
    left join ${tableName} as b on (a.coupon_id=b.id)
    <where>
      <trim suffixOverrides="and">
        #foreach($column in $columns)
        <if test="${column.lowerAttrName} != null ">
          and a.${column.columnName} = #{${column.lowerAttrName}},
        </if>
        #end
      </trim>
    </where>
    ORDER BY id desc
  </select>
</mapper>
